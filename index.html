<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Despachos - Registro</title>

  <!-- FAVICON -->
  <link rel="icon" type="image/jpeg" href="img/logo.jpeg">

  <!-- ESTILOS -->
  <link rel="stylesheet" href="assets/css/main.css">
</head>

<body>

  <!-- ================= HEADER ================= -->
  <header class="topbar">
    <div class="logo" style="display:flex;align-items:center;gap:10px;">
      <img src="img/logo.jpeg" alt="Logo Despachos" style="height:32px;width:auto;">
      ğŸšš Despachos
    </div>
    <div class="icons">ğŸ”” âœ‰ï¸ âš™ï¸</div>
  </header>

  <!-- ================= FICHAJE CHOFER ================= -->
  <main class="wrapper">

    <!-- âœ… NUEVO CONTENEDOR PARA LAYOUT PRO (NO ROMPE NADA) -->
    <div class="driver-layout">

      <!-- âœ… TU CARD IGUAL -->
      <div class="card">

        <h1 id="welcome">Bienvenido</h1>

        <p class="subtitle">
          TocÃ¡ el botÃ³n para registrar tu llegada al centro de despacho.
        </p>

        <!-- âœ… SELECTOR DE CHOFER -->
        <div style="text-align:left;margin:14px 0 18px;">
          <label for="driverSelect" style="font-weight:700;color:#0f172a;display:block;margin-bottom:6px;">
            SeleccionÃ¡ tu nombre
          </label>

          <select id="driverSelect" style="width:100%;padding:12px;border-radius:12px;border:1px solid #e5e7eb;">
            <option value="">Cargando...</option>
          </select>

          <p id="turnoInfo" style="margin:10px 0 0;font-size:13px;color:#475569;"></p>
        </div>

        <button id="btnFichar" class="primary-btn">
          Registrar llegada
        </button>

        <div id="loader" class="loader hidden">
          â³ Esperando confirmaciÃ³n de llegada...
        </div>

        <!-- âœ… NUEVO: MI HORARIO (PERSONAL - solo para ese chofer) -->
        <div id="mi-horario-box" style="display:none;margin-top:14px;text-align:left;"></div>

        <!-- âœ… NUEVO: BOTÃ“N QR PLEGABLE (arranca oculto; driver.js lo muestra cuando corresponda) -->
        <button
          id="btnToggleQR"
          type="button"
          style="display:none;margin-top:12px;width:100%;border:1px solid #e5e7eb;background:#fff;border-radius:12px;padding:12px;font-weight:800;cursor:pointer;">
          Mostrar QR
        </button>

        <!-- âœ… CONTENEDOR QR (AHORA PLEGABLE: arranca oculto) -->
        <div id="qr-container" style="margin-top:14px;text-align:center;display:none;"></div>

        <div class="divider"></div>

        <div class="section">
          <h3>UbicaciÃ³n</h3>
          <p>
            Centro de Despacho BIDCOM, Estomba 522, Buenos Aires.
          </p>
        </div>

      </div>

      <!-- âœ… AHORA EL ESTADO DEL DÃA VA AL COSTADO (desktop) -->
      <div id="hoy-box" class="hoy-side" style="display:none;">
        <h3 style="margin:0 0 10px;color:#0f172a;">ğŸ“‹ Estado del dÃ­a</h3>

        <div id="hoy-grid" style="display:grid;grid-template-columns:1fr 1fr;gap:12px;">
          <div style="background:#fff7ed;border:1px solid #fed7aa;border-radius:14px;padding:12px;">
            <div style="font-weight:900;color:#9a3412;margin-bottom:8px;">ğŸŸ¡ Pendientes</div>
            <ul id="lista-pendientes-chofer" style="list-style:none;padding:0;margin:0;display:flex;flex-direction:column;gap:10px;"></ul>
          </div>

          <div style="background:#ecfdf5;border:1px solid #bbf7d0;border-radius:14px;padding:12px;">
            <div style="font-weight:900;color:#166534;margin-bottom:8px;">ğŸŸ¢ Despachados</div>
            <ul id="lista-despachados-chofer" style="list-style:none;padding:0;margin:0;display:flex;flex-direction:column;gap:10px;"></ul>
          </div>
        </div>

        <p style="margin:10px 0 0;font-size:12px;color:#64748b;">
          Ordenado por hora de llegada.
        </p>
      </div>

    </div>
  </main>

  <!-- ================= PANEL OPERATIVO ================= -->
  <section id="panel" class="panel-wrapper">

    <h2 class="panel-title">Panel del dÃ­a</h2>

    <div class="panel-layout">

      <div class="panel-main">

        <div id="qr-despacho" style="margin:20px 0; display:none;">
          <h3>ğŸ“· Escanear QR para despachar</h3>
          <div id="qr-reader" style="max-width:320px"></div>
          <p id="qr-resultado" style="font-weight:bold;margin-top:10px;"></p>
        </div>

        <div class="panel-tablas">

          <div class="panel-col">
            <h3>ğŸŸ¡ Pendientes</h3>
            <ul id="lista-pendientes" class="lista"></ul>
          </div>

          <div class="panel-col">
            <h3>ğŸŸ¢ Despachados</h3>
            <ul id="lista-despachados" class="lista"></ul>
          </div>

        </div>
      </div>

      <aside class="panel-side">
        <div class="panel-resumen">

          <div class="resumen-item">
            <span class="resumen-label">Choferes activos</span>
            <span id="total-activos" class="resumen-value">0</span>
          </div>

          <div class="resumen-item">
            <span class="resumen-label">Pendientes</span>
            <span id="total-pendientes" class="resumen-value">0</span>
          </div>

          <div class="resumen-item">
            <span class="resumen-label">Despachados</span>
            <span id="total-despachados" class="resumen-value">0</span>
          </div>

        </div>
      </aside>

    </div>

    <div class="panel-signature">
      <strong>JUCAÂ®</strong>
    </div>

  </section>

  <!-- âœ… ESTILO SOLO PARA EL LAYOUT (despuÃ©s lo pasamos a main.css) -->
  <style>
    .driver-layout{
      width: 100%;
      max-width: 980px;
      margin: 0 auto;
      display: grid;
      grid-template-columns: 420px 1fr;
      gap: 18px;
      align-items: start;
    }

    .hoy-side{
      background: white;
      border-radius: 18px;
      padding: 18px;
      box-shadow: 0 40px 80px rgba(0,0,0,0.20);
    }

    @media (max-width: 1024px){
      .driver-layout{
        grid-template-columns: 1fr;
      }
      #hoy-grid{
        grid-template-columns: 1fr !important;
      }
    }
  </style>

  <!-- ================= SCRIPTS ================= -->
  <script type="module" src="assets/js/driver.js"></script>
  <script type="module" src="assets/js/panel.js"></script>

</body>
</html>
